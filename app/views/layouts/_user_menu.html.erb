<div style="position: relative; display: inline-block; text-align: left; font-family: Arial, sans-serif;">
  <div>
    <button type="button" style="display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 9999px; background-color: #4f46e5; color: white; transition: all 0.3s ease; border: none; cursor: pointer; outline: none; box-shadow: 0 2px 4px rgba(79, 70, 229, 0.3);" id="user-menu-button" aria-expanded="false" aria-haspopup="true">
      <span style="position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border-width: 0;">Open user menu</span>
      <svg style="height: 24px; width: 24px; transition: transform 0.3s ease;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A10.97 10.97 0 0112 14c3.019 0 5.8 1.173 7.879 3.11M12 14a7 7 0 100-14 7 7 0 000 14z" />
      </svg>
    </button>
  </div>

  <div style="position: absolute; right: 0; margin-top: 8px; width: 220px; border-radius: 8px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); background-color: white; border: 1px solid rgba(0, 0, 0, 0.05); opacity: 0; transform: translateY(-10px); transition: opacity 0.3s ease, transform 0.3s ease; display: none; overflow: hidden;" role="menu" aria-orientation="vertical" aria-labelledby="user-menu-button" tabindex="-1" id="user-menu">
    <div style="padding-top: 4px; padding-bottom: 4px;" role="none">
      <a href="/users/edit" style="display: block; padding: 10px 16px; font-size: 14px; color: #374151; text-decoration: none; transition: all 0.2s ease;" role="menuitem" tabindex="-1">
        <div style="display: flex; align-items: center;">
          <svg style="margin-right: 12px; height: 20px; width: 20px; color: #6366f1; transition: transform 0.2s ease;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
          </svg>
          <span style="transition: transform 0.2s ease;">Your Profile</span>
        </div>
      </a>
      <a href="#" style="display: block; padding: 10px 16px; font-size: 14px; color: #374151; text-decoration: none; transition: all 0.2s ease;" role="menuitem" tabindex="-1">
        <div style="display: flex; align-items: center;">
          <svg style="margin-right: 12px; height: 20px; width: 20px; color: #6366f1; transition: transform 0.2s ease;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
          </svg>
          <span style="transition: transform 0.2s ease;">Settings</span>
        </div>
      </a>
      <div style="border-top: 1px solid #f3f4f6; margin: 4px 0;"></div>
      <form action="/users/sign_out" method="post" style="display: block; width: 100%;">
        <input type="hidden" name="_method" value="delete">
        <button type="submit" style="display: block; width: 100%; text-align: left; padding: 10px 16px; font-size: 14px; color: #dc2626; background: none; border: none; cursor: pointer; transition: all 0.2s ease;" role="menuitem" tabindex="-1">
          <div style="display: flex; align-items: center;">
            <svg style="margin-right: 12px; height: 20px; width: 20px; color: #ef4444; transition: transform 0.2s ease;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z" clip-rule="evenodd" />
            </svg>
            <span style="transition: transform 0.2s ease;">Sign out</span>
          </div>
        </button>
      </form>
    </div>
  </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const userMenuButton = document.getElementById('user-menu-button');
        const userMenu = document.getElementById('user-menu');
        const menuItems = userMenu.querySelectorAll('a, button');

        function showMenu() {
            userMenu.style.display = 'block';
            setTimeout(() => {
                userMenu.style.opacity = '1';
                userMenu.style.transform = 'translateY(0)';
            }, 10);
            userMenuButton.setAttribute('aria-expanded', 'true');
        }

        function hideMenu() {
            userMenu.style.opacity = '0';
            userMenu.style.transform = 'translateY(-10px)';
            setTimeout(() => {
                userMenu.style.display = 'none';
            }, 300);
            userMenuButton.setAttribute('aria-expanded', 'false');
        }

        userMenuButton.addEventListener('click', function() {
            if (userMenu.style.display === 'none') {
                showMenu();
            } else {
                hideMenu();
            }
        });

        document.addEventListener('click', function(event) {
            if (!userMenuButton.contains(event.target) && !userMenu.contains(event.target)) {
                hideMenu();
            }
        });

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                hideMenu();
            }
        });

        userMenuButton.addEventListener('mouseover', function() {
            this.style.backgroundColor = '#4338ca';
            this.style.boxShadow = '0 4px 6px rgba(79, 70, 229, 0.4)';
            this.querySelector('svg').style.transform = 'scale(1.1)';
        });

        userMenuButton.addEventListener('mouseout', function() {
            this.style.backgroundColor = '#4f46e5';
            this.style.boxShadow = '0 2px 4px rgba(79, 70, 229, 0.3)';
            this.querySelector('svg').style.transform = 'scale(1)';
        });

        userMenuButton.addEventListener('focus', function() {
            this.style.boxShadow = '0 0 0 3px rgba(79, 70, 229, 0.5)';
        });

        userMenuButton.addEventListener('blur', function() {
            this.style.boxShadow = '0 2px 4px rgba(79, 70, 229, 0.3)';
        });

        menuItems.forEach(item => {
            item.addEventListener('mouseover', function() {
                this.style.backgroundColor = '#f3f4f6';
                this.querySelector('svg').style.transform = 'scale(1.1)';
                this.querySelector('span').style.transform = 'translateX(5px)';
            });

            item.addEventListener('mouseout', function() {
                this.style.backgroundColor = 'transparent';
                this.querySelector('svg').style.transform = 'scale(1)';
                this.querySelector('span').style.transform = 'translateX(0)';
            });

            item.addEventListener('focus', function() {
                this.style.backgroundColor = '#f3f4f6';
                this.style.outline = 'none';
                this.style.boxShadow = '0 0 0 2px #4f46e5';
            });

            item.addEventListener('blur', function() {
                this.style.backgroundColor = 'transparent';
                this.style.boxShadow = 'none';
            });
        });
    });
</script>